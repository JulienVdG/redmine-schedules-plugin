<div class="contextual">
    <%= link_to(l(:button_schedules_edit), {:controller => 'schedules', :action => 'edit', :date => @date, :project_id => @project}, :class => 'icon icon-edit') if @project && !@users.empty? %>
    <%= link_to(l(:button_schedules_fill), {:controller => 'schedules', :action => 'fill', :date => @date, :project_id => @project}, :class => 'icon icon-edit') if @project && !@users.empty?  %>
    <%= link_to(l(:button_schedules_edit), {:controller => 'schedules', :action => 'edit', :date => @date, :user_id => @user}, :class => 'icon icon-edit') if @user %>
    <%= link_to(l(:button_schedules_edit), {:controller => 'schedules', :action => 'edit', :date => @date, :user_id => User.current.id}, :class => 'icon icon-edit') unless @project || @user %>
    <%= link_to(l(:button_schedules_default_edit), {:controller => 'schedules', :action => 'default', :user_id => @user}, :class => 'icon icon-edit') if @user && (@user == User.current || User.current.admin?) %>
</div>

<h2>
    <%= l(:label_user_schedule, link_to_user(@user)).html_safe unless @user.nil? %>
    <%= l(:label_project_schedule) unless @project.nil? %>
    <%= l(:label_global_schedule) if @user.nil? && @project.nil? %>
</h2>

<% unless @entries.nil? %>

<p class="subtitle"><%= "#{l(:label_date_from)} #{format_date(@calendar.startdt)} #{l(:label_date_to).downcase} #{format_date(@calendar.enddt)}" %></p>

<%= render :partial => 'date_form' %>

<%= error_messages_for 'query' %>

<%= render :partial => 'calendar', :locals => {:calendar => @calendar} %>

<% else %>
    <p class="nodata"><%= l(:label_no_data) %></p>
<% end %>

<% html_title(l(:label_schedules_index)) -%>

<% content_for :header_tags do %>
    <%= stylesheet_link_tag 'schedules', :plugin => 'redmine_schedules' %>
<% end %>

<% content_for :sidebar do %>
    <%= render :partial => 'sidebar' %>
<% end %>
